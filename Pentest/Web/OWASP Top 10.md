# OWASP TOP TEN 2021

## 1. Broken Access Control
Việc kiểm soát truy cập thực thi chính sách sao cho người dùng không thể thực hiện các hành động vượt ngoài quyền của họ. Lỗi kiểm soát truy cập hỏng thường dẫn đến việc tiết lộ, sửa đổi hoặc phá hủy thông tin trái phép tất cả dữ liệu hoặc thực hiện các hành động khác ngoài quyền giới hạn của người dùng. Các lỗ hổng kiểm soát truy cập phổ biến bao gồm:

* Vi phạm nguyên tắc đặc quyền tối thiểu hoặc bị từ chối theo mặc định, trong đó quyền truy cập chỉ được cấp cho những người dùng cụ thể nhưng có sẵn cho bất kỳ ai.

* Bỏ qua kiểm tra kiểm soát truy cập bằng cách sửa đổi URL (giả mạo tham số hoặc buộc duyệt).

* Cho phép xem hoặc chỉnh sửa tài khoản của người khác bằng cách cung cấp mã định danh duy nhất của tài khoản đó (IDOR).

* Truy cập API mà thiếu các biện pháp kiểm soát truy cập cho POST, PUT và DELETE.

* Nâng cao đặc quyền. Hoạt động với tư cách người dùng mà không cần đăng nhập hoặc hoạt động với tư cách quản trị viên khi đăng nhập với tư cách người dùng.

* Giả mạo mã thông báo kiểm soát truy cập JSON Web Token (JWT), hoặc cookie hay trường ẩn bị thao túng để nâng cao đặc quyền hoặc lạm dụng tính năng vô hiệu hóa JWT.

* Cấu hình sai CORS cho phép truy cập API từ nguồn gốc trái phép/không đáng tin cậy.

* Buộc duyệt đến các trang cần được xác thực với tư cách là người dùng chưa được xác thực hoặc đến các trang cần đặc quyền cao với tư cách là người dùng đặc quyền thấp.

## 2. Cryptographic Failure
Các lỗ hổng về mật mã thường liên quan đến mã hóa bảo vệ dữ liệu truyền tải, hoặc độ mạnh các khóa bí mật và một số vấn đề khác. Các trường hợp phổ biến:

* Có dữ liệu nào được truyền dưới dạng văn bản rõ ràng không? Điều này liên quan đến các giao thức như HTTP, SMTP, FTP, liệu rằng các giao thức này có sử dụng các bản nâng cấp tích hợp TLS hay không.

* Có bất kỳ thuật toán hoặc giao thức mã hóa cũ hoặc yếu nào đang được sử dụng hay không?

* Có phải các khóa mật mã mặc định đang được sử dụng? Các khóa mật mã yếu được tạo hoặc sử dụng lại hoặc thiếu cơ chế quản lý khóa thích hợp? Khóa mật mã bị lộ trong mã nguồn không?

* Các hàm băm không được dùng nữa như MD5 hoặc SHA1 có đang được sử dụng hay các hàm băm không phải mật mã được sử dụng khi cần các hàm băm mật mã?

## 3. Injection
Một ứng dụng dễ bị tấn công Injection khi:

* Dữ liệu do người dùng cung cấp không được ứng dụng xác thực, lọc hoặc khử trùng.

* Các truy vấn động hoặc lệnh gọi không được tham số hóa mà giá trị đầu vào được sử dụng trực tiếp.

* Dữ liệu độc hại được sử dụng trong các tham số tìm kiếm ánh xạ quan hệ đối tượng (ORM) để trích xuất các bản ghi nhạy cảm, bổ sung.

* Dữ liệu độc hại được sử dụng trực tiếp hoặc nối vào các câu truy vấn SQL.

Một số cách chèn phổ biến là: SQL Injection, NoSQL, OS Command Injection, LDAP, XSS... Đánh giá mã nguồn là phương pháp tốt nhất để phát hiện xem ứng dụng có dễ bị tiêm nhiễm hay không. Để phát hiện các lỗ hổng Injection, nên kiểm tra tất cả các tham số, tiêu đề, URL, cookie, JSON, SOAP và dữ liệu đầu vào XML...

## 4. Insecure Design
 Insecure Design thường liên quan đến việc thiết kế hệ thống một cách không an toàn, dẫn đến các lỗ hổng bảo mật. Dưới đây là một số lỗi thiết kế không an toàn:

* Thiết kế không an toàn của cơ sở dữ liệu: Bao gồm lưu trữ mật khẩu không được mã hóa, không kiểm tra dữ liệu đầu vào, sử dụng cơ sở dữ liệu không an toàn như SQL không an toàn, v.v.

* Thiết kế không an toàn của giao diện người dùng: Bao gồm không xác thực, ủy quyền không an toàn, không kiểm tra dữ liệu đầu vào, v.v.

* Thiết kế không an toàn của kiến trúc hệ thống: Bao gồm việc không có các biện pháp bảo vệ đủ mạnh cho việc xử lý dữ liệu nhạy cảm, thiếu kiểm tra và cân nhắc về bảo mật khi tích hợp với các hệ thống bên ngoài, v.v.

* Thiết kế không an toàn của quy trình xác thực và ủy quyền: Bao gồm sử dụng phương thức xác thực yếu, không đủ hoặc không phù hợp với quy trình ủy quyền, v.v.

* Thiết kế không an toàn của giao tiếp giữa các thành phần: Bao gồm việc sử dụng giao thức không mã hóa hoặc không an toàn, không có kiểm tra toàn vẹn và xác thực, v.v.
## 5. Security Misconfiguration
Ứng dụng có thể dễ bị tấn công nếu ứng dụng đó:

* Thiếu biện pháp tăng cường bảo mật thích hợp hoặc các quyền được định cấu hình không đúng trên các dịch vụ Cloud.

* Các tính năng không cần thiết được bật hoặc cài đặt (ví dụ: cổng, dịch vụ, trang, tài khoản hoặc đặc quyền không cần thiết).

* Các tài khoản mặc định và mật khẩu của chúng vẫn được sử dụng và không thay đổi.

* Việc cấu hình xử lý lỗi không tốt có thể sẽ tiết lộ thông báo lỗi quá nhiều thông tin khác cho người dùng.

* Đối với các hệ thống được nâng cấp, các tính năng bảo mật mới nhất sẽ bị tắt hoặc không được cấu hình an toàn.

* Phần mềm đã lỗi thời chưa được cập nhật.

## 6. Vulnerable and Outdated Components
Ứng dụng có thể dễ bị tấn công nếu:

* Không biết phiên bản của tất cả các thành phần đang sử dụng (cả phía máy khách và phía máy chủ). Điều này bao gồm các thành phần bạn trực tiếp sử dụng cũng như các phần phụ thuộc lồng nhau.

* Phần mềm lỗi thời, chưa được nâng cấp dẫn đến dễ bị tấn công. Điều này bao gồm HĐH, máy chủ web/ứng dụng, hệ thống quản lý cơ sở dữ liệu (DBMS), ứng dụng, API và tất cả các thành phần, môi trường thời gian chạy và thư viện.

* Không quét lỗ hổng thường xuyên và đăng ký nhận các bản tin bảo mật liên quan đến các thành phần đang sử dụng.

* Không sửa chữa hoặc nâng cấp nền tảng, cập nhật các bản vá lỗi.

## 7. Identification and Authentication Failures 
Việc xác nhận danh tính, xác thực và quản lý phiên của người dùng là rất quan trọng để bảo vệ khỏi các cuộc tấn công liên quan đến xác thực. Các lỗ hổng về xác thực có thể xuất hiện nếu ứng dụng:

* Không kiểm soát các cuộc tấn công tự động như Bruteforce trong đó kẻ tấn công có danh sách tên người dùng và mật khẩu hợp lệ.

* Sử dụng các mật khẩu mặc định, yếu hoặc phổ biến, chẳng hạn như "Password1" hoặc "admin/admin".

* Sử dụng các quy trình khôi phục thông tin xác thực yếu hoặc không hiệu quả và quên mật khẩu, chẳng hạn như "câu trả lời dựa trên kiến ​​thức" không thể đảm bảo an toàn.

* Sử dụng kho lưu trữ dữ liệu mật khẩu ở dạng văn bản thuần túy.

* Xác thực đa yếu tố bị thiếu hoặc không hiệu quả.

* Hiển thị mã định danh phiên trong URL.

* Sử dụng lại mã định danh phiên sau khi đăng nhập thành công.

* Không vô hiệu hóa ID phiên đúng cách. Phiên người dùng hoặc mã thông báo xác thực (chủ yếu là mã thông báo đăng nhập một lần (SSO)) không bị vô hiệu hóa đúng cách khi đăng xuất hoặc trong khoảng thời gian không hoạt động.
## 8. Software and Data Integrity Failures
Lỗi về tính toàn vẹn của phần mềm và dữ liệu liên quan đến mã nguồn và cơ sở hạ tầng không bảo vệ khỏi các hành vi vi phạm tính toàn vẹn. Một ví dụ về điều này là khi một ứng dụng dựa vào các plugin, thư viện hoặc mô-đun từ các nguồn, kho lưu trữ và mạng phân phối nội dung (CDN) không đáng tin cậy. Đường dẫn CI/CD không an toàn có thể gây ra khả năng truy cập trái phép, mã độc hoặc xâm phạm hệ thống. Cuối cùng, nhiều ứng dụng hiện nay có chức năng tự động cập nhật, trong đó các bản cập nhật được tải xuống mà không cần xác minh tính toàn vẹn đầy đủ và áp dụng cho ứng dụng đáng tin cậy trước đó. Những kẻ tấn công có thể tải lên các bản cập nhật của riêng chúng để phân phối và chạy trên tất cả các bản cài đặt.
## 9. Security Logging and Monitoring Failures 
Nếu không ghi nhật ký và giám sát, các vi phạm sẽ không thể được phát hiện. Lỗi trong việc ghi nhật ký, phát hiện, giám sát và phản hồi tích cực sẽ xảy ra khi:

* Các sự kiện có thể kiểm tra, chẳng hạn như thông tin đăng nhập, thông tin đăng nhập thất bại và giao dịch có giá trị cao, không được ghi lại.

* Cảnh báo và lỗi tạo ra thông báo không đầy đủ hoặc không rõ ràng.

* Nhật ký của ứng dụng và API không được giám sát để phát hiện hoạt động đáng ngờ.

* Nhật ký chỉ được lưu trữ cục bộ.

* Chưa có ngưỡng cảnh báo phù hợp và quy trình leo thang phản hồi phù hợp hoặc chưa có hiệu quả.

* Ứng dụng không thể phát hiện, báo cáo hoặc cảnh báo các cuộc tấn công đang diễn ra trong thời gian thực hoặc gần thời gian thực.

* Hiển thị các sự kiện ghi nhật ký và cảnh báo cho người dùng hoặc kẻ tấn công.
## 10. Server Side Request Forgery
Lỗi SSRF xảy ra khi ứng dụng web tìm nạp tài nguyên từ xa mà không xác thực URL do người dùng cung cấp dẫn đến cho phép kẻ tấn công ép buộc ứng dụng gửi yêu cầu được tạo ra đến một đích không mong muốn.